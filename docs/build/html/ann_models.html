

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ANN models &mdash; ECoPANN 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Training sets" href="training_sets.html" />
    <link rel="prev" title="Package Reference" href="package_reference.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> ECoPANN
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickStart.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="package_reference.html">Package Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">ANN models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.element">ecopann.element</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.hpmodel">ecopann.hpmodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.nodeframe">ecopann.nodeframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.sequence">ecopann.sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.fcnet">ecopann.fcnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.optimize">ecopann.optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.train">ecopann.train</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ecopann.models">ecopann.models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="training_sets.html">Training sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter_estimation.html">Parameter estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_history.html">Release History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ECoPANN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="package_reference.html">Package Reference</a> &raquo;</li>
        
      <li>ANN models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ann_models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ann-models">
<span id="id1"></span><h1>ANN models<a class="headerlink" href="#ann-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-ecopann.element">
<span id="ecopann-element"></span><h2>ecopann.element<a class="headerlink" href="#module-ecopann.element" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ecopann.element.activation">
<code class="descclassname">ecopann.element.</code><code class="descname">activation</code><span class="sig-paren">(</span><em>active_name='rrelu'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Activation functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>active_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The name of activation function, which can be ‘relu’, ‘leakyrelu’, ‘prelu’, ‘rrelu’,
‘relu6’, ‘elu’, ‘selu’, ‘sigmoid’, ‘tanh’, or ‘softsign’. Default: ‘rrelu’</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Activation functions.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)">object</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although many activation functions are available, the recommended activation function is ‘rrelu’.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="ecopann.element.dropout">
<code class="descclassname">ecopann.element.</code><code class="descname">dropout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.dropout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.elu">
<code class="descclassname">ecopann.element.</code><code class="descname">elu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#elu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.elu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.get_dropout">
<code class="descclassname">ecopann.element.</code><code class="descname">get_dropout</code><span class="sig-paren">(</span><em>drouput_name='dropout'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#get_dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.get_dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dropout.</p>
</dd></dl>

<dl class="function">
<dt id="ecopann.element.leakyrelu">
<code class="descclassname">ecopann.element.</code><code class="descname">leakyrelu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#leakyrelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.leakyrelu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.prelu">
<code class="descclassname">ecopann.element.</code><code class="descname">prelu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#prelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.prelu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.relu">
<code class="descclassname">ecopann.element.</code><code class="descname">relu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#relu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.relu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.relu6">
<code class="descclassname">ecopann.element.</code><code class="descname">relu6</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#relu6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.relu6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.rrelu">
<code class="descclassname">ecopann.element.</code><code class="descname">rrelu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#rrelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.rrelu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.selu">
<code class="descclassname">ecopann.element.</code><code class="descname">selu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#selu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.selu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.sigmoid">
<code class="descclassname">ecopann.element.</code><code class="descname">sigmoid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#sigmoid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.sigmoid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.softsign">
<code class="descclassname">ecopann.element.</code><code class="descname">softsign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#softsign"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.softsign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.element.tanh">
<code class="descclassname">ecopann.element.</code><code class="descname">tanh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/element.html#tanh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.element.tanh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ecopann.hpmodel">
<span id="ecopann-hpmodel"></span><h2>ecopann.hpmodel<a class="headerlink" href="#module-ecopann.hpmodel" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ecopann.hpmodel.default">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">default</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_1">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_2">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_3">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_4">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_4</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_5">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_5</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_6">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_6</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.eco_7">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">eco_7</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#eco_7"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.eco_7" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.models">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">models</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.models" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyperparameter models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Hyperparameter model that contains hyperparameters (such as activation function, batch normalization, dropout, etc.) used in the network.
It can be ‘eco_1’, ‘eco_2’, ‘eco_3’, ‘eco_4’, ‘eco_5’, ‘eco_6’, or ‘eco_7’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Hyperparameter model.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)">object</a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The hyperparameters model ‘eco_3’ that contains the ‘rrelu’ activation function is recommended.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="ecopann.hpmodel.nuisance_hp">
<code class="descclassname">ecopann.hpmodel.</code><code class="descname">nuisance_hp</code><span class="sig-paren">(</span><em>hparams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/hpmodel.html#nuisance_hp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.hpmodel.nuisance_hp" title="Permalink to this definition">¶</a></dt>
<dd><p>The hyperparameters that could be set to deterministic values.</p>
</dd></dl>

</div>
<div class="section" id="module-ecopann.nodeframe">
<span id="ecopann-nodeframe"></span><h2>ecopann.nodeframe<a class="headerlink" href="#module-ecopann.nodeframe" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ecopann.nodeframe.decreasingNode">
<code class="descclassname">ecopann.nodeframe.</code><code class="descname">decreasingNode</code><span class="sig-paren">(</span><em>node_in=1970</em>, <em>node_out=5</em>, <em>hidden_layer=3</em>, <em>get_allNode=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/nodeframe.html#decreasingNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.nodeframe.decreasingNode" title="Permalink to this definition">¶</a></dt>
<dd><p>A network structure that the number of neurons in each hidden layer is decreased proportionally.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of nodes in the input layer.</li>
<li><strong>node_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of nodes in the output layer.</li>
<li><strong>hidden_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the hidden layers.</li>
<li><strong>get_allNode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, return the number of all nodes, otherwise, only return the number of nodes of hidden layers. Default: True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list that contains the number of nodes in each layer.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ecopann.sequence">
<span id="ecopann-sequence"></span><h2>ecopann.sequence<a class="headerlink" href="#module-ecopann.sequence" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ecopann.sequence.Activation">
<em class="property">class </em><code class="descclassname">ecopann.sequence.</code><code class="descname">Activation</code><a class="reference internal" href="_modules/ecopann/sequence.html#Activation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.Activation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Activation functions, to be used by class <a class="reference internal" href="#ecopann.sequence.LinearSeq" title="ecopann.sequence.LinearSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearSeq</span></code></a>.</p>
</dd></dl>

<dl class="class">
<dt id="ecopann.sequence.BatchNorm">
<em class="property">class </em><code class="descclassname">ecopann.sequence.</code><code class="descname">BatchNorm</code><a class="reference internal" href="_modules/ecopann/sequence.html#BatchNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.BatchNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Batch Normalization, to be used by class <a class="reference internal" href="#ecopann.sequence.LinearSeq" title="ecopann.sequence.LinearSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearSeq</span></code></a>.</p>
</dd></dl>

<dl class="class">
<dt id="ecopann.sequence.Dropout">
<em class="property">class </em><code class="descclassname">ecopann.sequence.</code><code class="descname">Dropout</code><a class="reference internal" href="_modules/ecopann/sequence.html#Dropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.Dropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Dropout, to be used by class <a class="reference internal" href="#ecopann.sequence.LinearSeq" title="ecopann.sequence.LinearSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearSeq</span></code></a>.</p>
</dd></dl>

<dl class="class">
<dt id="ecopann.sequence.LinearSeq">
<em class="property">class </em><code class="descclassname">ecopann.sequence.</code><code class="descname">LinearSeq</code><span class="sig-paren">(</span><em>nodes</em>, <em>mainBN=True</em>, <em>finalBN=False</em>, <em>mainActive='rrelu'</em>, <em>finalActive='None'</em>, <em>mainDropout='None'</em>, <em>finalDropout='None'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/sequence.html#LinearSeq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.LinearSeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ecopann.sequence.SeqName" title="ecopann.sequence.SeqName"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.sequence.SeqName</span></code></a>, <a class="reference internal" href="#ecopann.sequence.BatchNorm" title="ecopann.sequence.BatchNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.sequence.BatchNorm</span></code></a>, <a class="reference internal" href="#ecopann.sequence.Activation" title="ecopann.sequence.Activation"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.sequence.Activation</span></code></a>, <a class="reference internal" href="#ecopann.sequence.Dropout" title="ecopann.sequence.Dropout"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.sequence.Dropout</span></code></a></p>
<p>Sequence of Linear.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list that contains the number of nodes in each layer.</li>
<li><strong>mainBN</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the network will contain batch normalization layer in its main part. Default: True</li>
<li><strong>finalBN</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the network will contain batch normalization layer in its last layer. Default: False</li>
<li><strong>mainActive</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The activation function used in the main part of the network. See <a class="reference internal" href="#ecopann.element.activation" title="ecopann.element.activation"><code class="xref py py-func docutils literal notranslate"><span class="pre">activation()</span></code></a> for the available activation functions. Default: ‘rrelu’</li>
<li><strong>finalActive</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The activation function used in the last layer of the network. See <a class="reference internal" href="#ecopann.element.activation" title="ecopann.element.activation"><code class="xref py py-func docutils literal notranslate"><span class="pre">activation()</span></code></a> for the available activation functions. Default: ‘None’</li>
<li><strong>mainDropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The dropout used in the main part of the network, ‘None’ or ‘dropout’. Default: ‘None’</li>
<li><strong>finalDropout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The dropout used in the final layer of the network, ‘None’ or ‘dropout’. Default: ‘None’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ecopann.sequence.LinearSeq.get_seq">
<code class="descname">get_seq</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/sequence.html#LinearSeq.get_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.LinearSeq.get_seq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ecopann.sequence.SeqName">
<em class="property">class </em><code class="descclassname">ecopann.sequence.</code><code class="descname">SeqName</code><span class="sig-paren">(</span><em>module_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/sequence.html#SeqName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.SeqName" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The name of sequence, to be used by class <a class="reference internal" href="#ecopann.sequence.LinearSeq" title="ecopann.sequence.LinearSeq"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearSeq</span></code></a>.</p>
<dl class="method">
<dt id="ecopann.sequence.SeqName.seq_name">
<code class="descname">seq_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/sequence.html#SeqName.seq_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.sequence.SeqName.seq_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ecopann.fcnet">
<span id="ecopann-fcnet"></span><h2>ecopann.fcnet<a class="headerlink" href="#module-ecopann.fcnet" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ecopann.fcnet.FcNet">
<em class="property">class </em><code class="descclassname">ecopann.fcnet.</code><code class="descname">FcNet</code><span class="sig-paren">(</span><em>nodes</em>, <em>mainActive='rrelu'</em>, <em>finalActive='None'</em>, <em>mainBN=False</em>, <em>finalBN=False</em>, <em>mainDropout='None'</em>, <em>finalDropout='None'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#FcNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.FcNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="ecopann.fcnet.FcNet.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#FcNet.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.FcNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ecopann.fcnet.MultiBranchFcNet">
<em class="property">class </em><code class="descclassname">ecopann.fcnet.</code><code class="descname">MultiBranchFcNet</code><span class="sig-paren">(</span><em>nodes_all</em>, <em>mainActive='rrelu'</em>, <em>finalActive='None'</em>, <em>mainBN=False</em>, <em>finalBN=False</em>, <em>mainDropout='None'</em>, <em>finalDropout='None'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#MultiBranchFcNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.MultiBranchFcNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="ecopann.fcnet.MultiBranchFcNet.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x_all</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#MultiBranchFcNet.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.MultiBranchFcNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ecopann.fcnet.get_FcNet">
<code class="descclassname">ecopann.fcnet.</code><code class="descname">get_FcNet</code><span class="sig-paren">(</span><em>node_in=2000</em>, <em>node_out=6</em>, <em>hidden_layer=3</em>, <em>nodes=None</em>, <em>hparams={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#get_FcNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.get_FcNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a fully connected network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>node_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the input nodes.</li>
<li><strong>node_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the output nodes.</li>
<li><strong>hidden_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the hidden layers.</li>
<li><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – If list, it should be a collection of nodes of the network, e.g. [node_in, node_hidden1, node_hidden2, …, node_out]</li>
<li><strong>hparams</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary of hyperparameters (or hidden parameters, such as the activation function,
the batch normalization, and the dropout) of the netwowrk. See <a class="reference internal" href="#ecopann.hpmodel.models" title="ecopann.hpmodel.models"><code class="xref py py-func docutils literal notranslate"><span class="pre">models()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ecopann.fcnet.get_MultiBranchFcNet">
<code class="descclassname">ecopann.fcnet.</code><code class="descname">get_MultiBranchFcNet</code><span class="sig-paren">(</span><em>nodes_in=[100, 100, 20], node_out=6, branch_hiddenLayer=1, trunk_hiddenLayer=3, nodes_all=None, hparams={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/fcnet.html#get_MultiBranchFcNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.fcnet.get_MultiBranchFcNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a multibranch network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nodes_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – The number of the input nodes for each branch. e.g. [node_in_branch1, node_in_branch2, …]</li>
<li><strong>node_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the output nodes.</li>
<li><strong>branch_hiddenLayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the hidden layers for the branch part.</li>
<li><strong>trunk_hiddenLayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of the hidden layers for the trunk part.</li>
<li><strong>nodes_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – The number of nodes of the multibranch network. e.g. [nodes_branch1, nodes_branch2, …, nodes_trunk]</li>
<li><strong>hparams</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary of hyperparameters (or hidden parameters, such as the activation function,
the batch normalization, and the dropout) of the netwowrk. See <a class="reference internal" href="#ecopann.hpmodel.models" title="ecopann.hpmodel.models"><code class="xref py py-func docutils literal notranslate"><span class="pre">models()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ecopann.optimize">
<span id="ecopann-optimize"></span><h2>ecopann.optimize<a class="headerlink" href="#module-ecopann.optimize" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ecopann.optimize.LrDecay">
<em class="property">class </em><code class="descclassname">ecopann.optimize.</code><code class="descname">LrDecay</code><span class="sig-paren">(</span><em>iter_mid</em>, <em>iteration=10000</em>, <em>lr=0.1</em>, <em>lr_min=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/optimize.html#LrDecay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.optimize.LrDecay" title="Permalink to this definition">¶</a></dt>
<dd><p>Let the learning rate decay with iteration.</p>
<dl class="method">
<dt id="ecopann.optimize.LrDecay.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>gamma=0.999</em>, <em>auto_params=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/optimize.html#LrDecay.exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.optimize.LrDecay.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential decay.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>auto_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, gamma is set automatically.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">lr * gamma^iteration</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ecopann.optimize.LrDecay.poly">
<code class="descname">poly</code><span class="sig-paren">(</span><em>decay_step=500</em>, <em>power=0.999</em>, <em>cycle=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/optimize.html#LrDecay.poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.optimize.LrDecay.poly" title="Permalink to this definition">¶</a></dt>
<dd><p>Polynomial decay.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(lr-lr_min) * (1 - iteration/decay_steps)^power +lr_min</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ecopann.optimize.LrDecay.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>stepsize=1000</em>, <em>gamma=0.3</em>, <em>auto_params=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/optimize.html#LrDecay.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.optimize.LrDecay.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Let the learning rate decays step by step, similar to ‘exp’.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ecopann.train">
<span id="ecopann-train"></span><h2>ecopann.train<a class="headerlink" href="#module-ecopann.train" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ecopann.train.Train">
<em class="property">class </em><code class="descclassname">ecopann.train.</code><code class="descname">Train</code><span class="sig-paren">(</span><em>net</em>, <em>loss_func='L1'</em>, <em>iteration=10000</em>, <em>optimizer='Adam'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="ecopann.train.Train.call_GPU">
<code class="descname">call_GPU</code><span class="sig-paren">(</span><em>prints=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.call_GPU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.call_GPU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.train.Train.check_GPU">
<code class="descname">check_GPU</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.check_GPU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.check_GPU" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.train.Train.train_0">
<code class="descname">train_0</code><span class="sig-paren">(</span><em>xx</em>, <em>yy</em>, <em>iter_mid</em>, <em>repeat_n=3</em>, <em>lr_decay=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.train_0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.train_0" title="Permalink to this definition">¶</a></dt>
<dd><p>Training batch samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xx</strong> (<em>torch tensor</em>) – The input of the network.</li>
<li><strong>yy</strong> (<em>torch tensor</em>) – The target of the network.</li>
<li><strong>iter_mid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The i-th iteration.</li>
<li><strong>repeat_n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of iterations using the same batch of data during network training,
which is usually set to 1 or 3. Default: 3</li>
<li><strong>lr_decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the learning rate will decrease with the iteration, otherwise, the learning rate will not change.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>float</em> – The loss.</li>
<li><em>Tensor</em> – The predicted values.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ecopann.train.Train.train_1">
<code class="descname">train_1</code><span class="sig-paren">(</span><em>inputs</em>, <em>target</em>, <em>repeat_n=1</em>, <em>set_seed=False</em>, <em>lr_decay=True</em>, <em>print_info=True</em>, <em>showIter_n=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.train_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.train_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Training the training set (or a subsample of the training set).</p>
</dd></dl>

<dl class="method">
<dt id="ecopann.train.Train.transfer_data">
<code class="descname">transfer_data</code><span class="sig-paren">(</span><em>device=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.transfer_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.transfer_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.train.Train.transfer_net">
<code class="descname">transfer_net</code><span class="sig-paren">(</span><em>use_DDP=False</em>, <em>device_ids=None</em>, <em>prints=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#Train.transfer_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.Train.transfer_net" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ecopann.train.loss_funcs">
<code class="descclassname">ecopann.train.</code><code class="descname">loss_funcs</code><span class="sig-paren">(</span><em>name='L1'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/train.html#loss_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.train.loss_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Some loss functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Abbreviation of loss function name. ‘L1’, ‘MSE’, or ‘SmoothL1’. Default: ‘L1’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The corresponding loss function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)">object</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-ecopann.models">
<span id="ecopann-models"></span><h2>ecopann.models<a class="headerlink" href="#module-ecopann.models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ecopann.models.MLP">
<em class="property">class </em><code class="descclassname">ecopann.models.</code><code class="descname">MLP</code><span class="sig-paren">(</span><em>spectra</em>, <em>parameters</em>, <em>param_names</em>, <em>params_dict=None</em>, <em>obs_errors=None</em>, <em>cov_matrix=None</em>, <em>hidden_layer=3</em>, <em>hp_model='eco_3'</em>, <em>loss_func='L1'</em>, <em>noise_type='multiSigma'</em>, <em>noise_sigma=0.5</em>, <em>multi_noise=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ecopann.train.Train" title="ecopann.train.Train"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.train.Train</span></code></a></p>
<p>Multilayer perceptron (MLP) that is used to predict cosmological parameters with one set of datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spectra</strong> (<em>array-like</em>) – The simulated observational spectra (data) with shape (N, spectra_length).</li>
<li><strong>parameters</strong> (<em>array-like</em>) – The simulated parameters of a specific cosmological (or theoretical) model.</li>
<li><strong>param_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list which contains the parameter names, e.g. [‘H0’,’Omega_m’,’ombh2’,’omch2’,’tau’,’As’,’ns’].</li>
<li><strong>params_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Information of cosmological parameters that include the labels, the base values, the minimum values,
and the maximum values. See <a class="reference internal" href="training_sets.html#ecopann.cosmic_params.params_dict_zoo" title="ecopann.cosmic_params.params_dict_zoo"><code class="xref py py-func docutils literal notranslate"><span class="pre">params_dict_zoo()</span></code></a>. Default: None</li>
<li><strong>obs_errors</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Observational errors with shape (spectra_length,). Default: None</li>
<li><strong>cov_matrix</strong> (<em>array-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Covariance matrix of the observational data. Default: None</li>
<li><strong>hidden_layer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of the hidden layer of the network. Default: 3</li>
<li><strong>hp_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Hyperparameter model that contains hyperparameters (such as activation function, batch normalization, dropout, etc.) used in the network.
It can be ‘eco_1’, ‘eco_2’, ‘eco_3’, ‘eco_4’, ‘eco_5’, ‘eco_6’, or ‘eco_7’ (see <a class="reference internal" href="#ecopann.hpmodel.models" title="ecopann.hpmodel.models"><code class="xref py py-func docutils literal notranslate"><span class="pre">models()</span></code></a>). Default: ‘eco_3’</li>
<li><strong>loss_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The loss function used in the network. Default: ‘L1’</li>
<li><strong>noise_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The type of Gaussian noise added to the training set, ‘singleSigma’ or ‘multiSigma’. Default: ‘multiSigma’</li>
<li><strong>noise_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – For the case of ‘singleSigma’, it is the standard deviation of the Gaussian noise, while for the case of ‘multiSigma’ it is
a coefficient of the standard deviation. Default: 0.5</li>
<li><strong>multi_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of realization of noise added to a spectrum. Default: 5</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The learning rate setting of the network. Default: 1e-2</li>
<li><strong>lr_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The minimum of the learning rate. Default: 1e-8</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The batch size setting of the network. Default: 750</li>
<li><strong>auto_batchSize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the batch size will be set automatically in the training process, otherwise, use the setting of <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>. Default: True</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of epoch of the training process. Default: 2000</li>
<li><a class="reference internal" href="parameter_estimation.html#ecopann.ann.ANN.base_epoch" title="ecopann.ann.ANN.base_epoch"><strong>base_epoch</strong></a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The base number (or the minimum number) of epoch. Default: 1000</li>
<li><strong>auto_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the epoch will be set automatically in the training process, otherwise, use the setting of <code class="docutils literal notranslate"><span class="pre">epoch</span></code>. Default: True</li>
<li><strong>norm_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the input data of the network will be normalized. Default: True</li>
<li><strong>norm_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the target data (cosmological parameters) will be normalized. Default: True</li>
<li><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The method of normalization, ‘z_score’, ‘minmax’, or ‘mean’ (see <a class="reference internal" href="training_sets.html#ecopann.data_processor.Normalize" title="ecopann.data_processor.Normalize"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normalize</span></code></a>). Default: ‘z_score’</li>
<li><strong>spaceSigma_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum parameter space to be learned, e.g. for spaceSigma_min=5, the parameter space to be learned is <span class="math notranslate nohighlight">\([-5\sigma, +5\sigma]\)</span>. Default: 5</li>
<li><strong>transfer_learning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the network will be initialized using the well-trained network of the previous step. Default: False</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ecopann.models.MLP.copyLayers_fromTrainedNet">
<code class="descname">copyLayers_fromTrainedNet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.copyLayers_fromTrainedNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.copyLayers_fromTrainedNet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.load_wellTrainedNet">
<code class="descname">load_wellTrainedNet</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>randn_num='0.123'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.load_wellTrainedNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.load_wellTrainedNet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.plot_loss">
<code class="descname">plot_loss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.plot_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.plot_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>spectra</em>, <em>in_type='numpy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.predict_chain">
<code class="descname">predict_chain</code><span class="sig-paren">(</span><em>obs_spectra</em>, <em>cov_matrix=None</em>, <em>chain_leng=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.predict_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.predict_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.save_chain">
<code class="descname">save_chain</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.save_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.save_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.save_hparams">
<code class="descname">save_hparams</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.save_hparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.save_hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.save_loss">
<code class="descname">save_loss</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.save_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.save_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.save_net">
<code class="descname">save_net</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.save_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.save_net" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.statistic">
<code class="descname">statistic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.statistic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>repeat_n=3</em>, <em>showIter_n=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MLP.transfer_data">
<code class="descname">transfer_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MLP.transfer_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MLP.transfer_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ecopann.models.MultiBranchNet">
<em class="property">class </em><code class="descclassname">ecopann.models.</code><code class="descname">MultiBranchNet</code><span class="sig-paren">(</span><em>spectra</em>, <em>parameters</em>, <em>param_names</em>, <em>params_dict=None</em>, <em>obs_errors=None</em>, <em>cov_matrix=None</em>, <em>branch_hiddenLayer=2</em>, <em>trunk_hiddenLayer=1</em>, <em>hp_model='eco_3'</em>, <em>loss_func='L1'</em>, <em>noise_type='multiSigma'</em>, <em>noise_sigma=0.5</em>, <em>multi_noise=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ecopann.models.MLP" title="ecopann.models.MLP"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.models.MLP</span></code></a></p>
<p>Multibranch network that is used to predict cosmological parameters with multiple sets of datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spectra</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Simulated observational spectra (data), it is a list spectra with shape [(N,spectra_length_1), (N,spectra_length_2), …].</li>
<li><strong>parameters</strong> (<em>array-like</em>) – The simulated parameters of a specific cosmological (or theoretical) model.</li>
<li><strong>param_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list which contains the parameter names, e.g. [‘H0’,’Omega_m’,’ombh2’,’omch2’,’tau’,’As’,’ns’].</li>
<li><strong>params_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Information of cosmological parameters that include the labels, the base values, the minimum values,
and the maximum values. See <a class="reference internal" href="training_sets.html#ecopann.cosmic_params.params_dict_zoo" title="ecopann.cosmic_params.params_dict_zoo"><code class="xref py py-func docutils literal notranslate"><span class="pre">params_dict_zoo()</span></code></a>. Default: None</li>
<li><strong>obs_errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Observational errors, it is a list of errors with shape [(spectra_length_1,), (spectra_length_2,), …]. Default: None</li>
<li><strong>cov_matrix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – A list of covariance matrix with shape [(spectra_length_1, spectra_length_1), (spectra_length_2, spectra_length_2), …].
If there is no covariance for some observations, the covariance matrix should be set to None. e.g. [cov_matrix_1, None, cov_matrix_3]. Default: None</li>
<li><strong>branch_hiddenLayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of the hidden layer for the branch part of the network. Default: 2</li>
<li><strong>trunk_hiddenLayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of the hidden layer for the trunk part of the network. Default: 1</li>
<li><strong>hp_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Hyperparameter model that contains hyperparameters (such as activation function, batch normalization, dropout, etc.) used in the network.
It can be ‘eco_1’, ‘eco_2’, ‘eco_3’, ‘eco_4’, ‘eco_5’, ‘eco_6’, or ‘eco_7’ (see <a class="reference internal" href="#ecopann.hpmodel.models" title="ecopann.hpmodel.models"><code class="xref py py-func docutils literal notranslate"><span class="pre">models()</span></code></a>). Default: ‘eco_3’</li>
<li><strong>loss_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The loss function used in the network. Default: ‘L1’</li>
<li><strong>noise_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The type of Gaussian noise added to the training set, ‘singleSigma’ or ‘multiSigma’. Default: ‘multiSigma’</li>
<li><strong>noise_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – For the case of ‘singleSigma’, it is the standard deviation of the Gaussian noise, while for the case of ‘multiSigma’ it is
a coefficient of the standard deviation. Default: 0.5</li>
<li><strong>multi_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of realization of noise added to a spectrum. Default: 5</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The learning rate setting of the network. Default: 1e-2</li>
<li><strong>lr_branch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The learning rate setting of the branch part. Default: 1e-2</li>
<li><strong>lr_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The minimum of the learning rate. Default: 1e-8</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The batch size setting of the network. Default: 750</li>
<li><strong>auto_batchSize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the batch size will be set automatically in the training process, otherwise, use the setting of <code class="docutils literal notranslate"><span class="pre">batch_size</span></code>. Default: True</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of epoch of the training process. Default: 2000</li>
<li><strong>epoch_branch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of epoch for the branch part. This only works when training the branch part. Default: 2000</li>
<li><a class="reference internal" href="parameter_estimation.html#ecopann.ann.ANN.base_epoch" title="ecopann.ann.ANN.base_epoch"><strong>base_epoch</strong></a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The base number (or the minimum number) of epoch. Default: 1000</li>
<li><strong>auto_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the epoch will be set automatically in the training process, otherwise, use the setting of <code class="docutils literal notranslate"><span class="pre">epoch</span></code>. Default: True</li>
<li><strong>norm_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the input data of the network will be normalized. Default: True</li>
<li><strong>norm_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the target data (cosmological parameters) will be normalized. Default: True</li>
<li><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The method of normalization, ‘z_score’, ‘minmax’, or ‘mean’ (see <a class="reference internal" href="training_sets.html#ecopann.data_processor.Normalize" title="ecopann.data_processor.Normalize"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normalize</span></code></a>). Default: ‘z_score’</li>
<li><strong>spaceSigma_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum parameter space to be learned, e.g. for spaceSigma_min=5, the parameter space to be learned is <span class="math notranslate nohighlight">\([-5\sigma, +5\sigma]\)</span>. Default: 5</li>
<li><strong>transfer_learning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the network will be initialized using the well-trained network of the previous step. Default: False</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is suggested to set lr and lr_branch the same value.</p>
</div>
<dl class="method">
<dt id="ecopann.models.MultiBranchNet.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>spectra</em>, <em>in_type='numpy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.predict_chain">
<code class="descname">predict_chain</code><span class="sig-paren">(</span><em>obs_spectra</em>, <em>cov_matrix=None</em>, <em>chain_leng=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.predict_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.predict_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.save_chain">
<code class="descname">save_chain</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample='TT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.save_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.save_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.save_hparams">
<code class="descname">save_hparams</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample='TT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.save_hparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.save_hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.save_loss">
<code class="descname">save_loss</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample='TT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.save_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.save_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.save_net">
<code class="descname">save_net</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>sample='TT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.save_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.save_net" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.statistic">
<code class="descname">statistic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.statistic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>repeat_n=3</em>, <em>showIter_n=100</em>, <em>train_branch=True</em>, <em>parallel=True</em>, <em>train_trunk=False</em>, <em>fix_lr=0.0001</em>, <em>reduce_fix_lr=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.transfer_branchNet">
<code class="descname">transfer_branchNet</code><span class="sig-paren">(</span><em>device=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.transfer_branchNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.transfer_branchNet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.MultiBranchNet.transfer_data">
<code class="descname">transfer_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#MultiBranchNet.transfer_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.MultiBranchNet.transfer_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ecopann.models.RePredictMBNet">
<em class="property">class </em><code class="descclassname">ecopann.models.</code><code class="descname">RePredictMBNet</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>randn_num='0.123'</em>, <em>params_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMBNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMBNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ecopann.models.MultiBranchNet" title="ecopann.models.MultiBranchNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.models.MultiBranchNet</span></code></a></p>
<p>Repredict cosmological parameters using the saved networks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The path of the results saved. Default: ‘ann’</li>
<li><strong>randn_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – A random number that identifies the saved results.</li>
<li><strong>params_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Information of cosmological parameters that include the labels, the base values, the minimum values,
and the maximum values. See <a class="reference internal" href="training_sets.html#ecopann.cosmic_params.params_dict_zoo" title="ecopann.cosmic_params.params_dict_zoo"><code class="xref py py-func docutils literal notranslate"><span class="pre">params_dict_zoo()</span></code></a>. Default: None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>norm_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the input data of the network will be normalized. Default: True</li>
<li><strong>norm_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the target data (cosmological parameters) will be normalized. Default: True</li>
<li><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The method of normalization, ‘z_score’, ‘minmax’, or ‘mean’ (see <a class="reference internal" href="training_sets.html#ecopann.data_processor.Normalize" title="ecopann.data_processor.Normalize"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normalize</span></code></a>). Default: ‘z_score’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ecopann.models.RePredictMBNet.load_chain">
<code class="descname">load_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMBNet.load_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMBNet.load_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMBNet.load_hparams">
<code class="descname">load_hparams</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMBNet.load_hparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMBNet.load_hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMBNet.load_loss">
<code class="descname">load_loss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMBNet.load_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMBNet.load_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMBNet.load_net">
<code class="descname">load_net</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMBNet.load_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMBNet.load_net" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ecopann.models.RePredictMLP">
<em class="property">class </em><code class="descclassname">ecopann.models.</code><code class="descname">RePredictMLP</code><span class="sig-paren">(</span><em>path='ann'</em>, <em>randn_num='0.123'</em>, <em>params_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMLP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ecopann.models.MLP" title="ecopann.models.MLP"><code class="xref py py-class docutils literal notranslate"><span class="pre">ecopann.models.MLP</span></code></a></p>
<p>Repredict cosmological parameters using the saved networks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The path of the results saved. Default: ‘ann’</li>
<li><strong>randn_num</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – A random number that identifies the saved results.</li>
<li><strong>params_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Information of cosmological parameters that include the labels, the base values, the minimum values,
and the maximum values. See <a class="reference internal" href="training_sets.html#ecopann.cosmic_params.params_dict_zoo" title="ecopann.cosmic_params.params_dict_zoo"><code class="xref py py-func docutils literal notranslate"><span class="pre">params_dict_zoo()</span></code></a>. Default: None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>norm_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the input data of the network will be normalized. Default: True</li>
<li><strong>norm_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the target data (cosmological parameters) will be normalized. Default: True</li>
<li><strong>norm_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The method of normalization, ‘z_score’, ‘minmax’, or ‘mean’ (see <a class="reference internal" href="training_sets.html#ecopann.data_processor.Normalize" title="ecopann.data_processor.Normalize"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normalize</span></code></a>). Default: ‘z_score’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ecopann.models.RePredictMLP.load_chain">
<code class="descname">load_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMLP.load_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMLP.load_chain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMLP.load_hparams">
<code class="descname">load_hparams</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMLP.load_hparams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMLP.load_hparams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMLP.load_loss">
<code class="descname">load_loss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMLP.load_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMLP.load_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ecopann.models.RePredictMLP.load_net">
<code class="descname">load_net</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/ecopann/models.html#RePredictMLP.load_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ecopann.models.RePredictMLP.load_net" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="training_sets.html" class="btn btn-neutral float-right" title="Training sets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="package_reference.html" class="btn btn-neutral float-left" title="Package Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Guojian Wang

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>